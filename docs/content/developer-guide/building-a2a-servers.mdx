---
title: Building A2A Servers
description: Create and host your own A2A-compatible agents
---

# Building A2A Servers

This guide shows you how to create A2A servers that host your existing LangChain, CrewAI, AutoGen, or custom agent code and expose them to ARK using the A2A protocol.

## Quick Start

### Use the Simple Agent Sample (Recommended)

The easiest way to get started is with the [Simple Agent sample](https://github.com/mckinsey/agents-at-scale-ark/tree/main/samples/a2a/simple-agent):

```bash
cd samples/a2a/simple-agent
make init
make dev
```

This gives you a complete A2A server with:
- ✅ Basic conversation capabilities
- ✅ Simple math operations  
- ✅ Echo functionality
- ✅ Production-ready deployment (Docker, Helm charts)
- ✅ Comprehensive error handling

## Testing Your A2A Server

### Option 1: A2A Inspector (Recommended)

```bash
# Install the A2A Inspector
npm install -g @a2a-integration/inspector

# Start the inspector
a2a-inspector
```

Then enter your server URL: `http://localhost:8000`

### Option 2: Manual Testing with curl

```bash
# Test agent discovery
curl http://localhost:8000/.well-known/agent.json | jq .

# Test health endpoint
curl http://localhost:8000/health

# Send a message
curl -X POST http://localhost:8000/ \
  -H "Content-Type: application/json" \
  -d '{
    "jsonrpc": "2.0",
    "method": "message/send",
    "params": {
      "message": {
        "messageId": "test-1",
        "contextId": "ctx-1",
        "role": "user",
        "parts": [{"kind": "text", "text": "Hello world"}]
      }
    },
    "id": 1
  }' | jq .
```

## Integrating with ARK

Once your A2A server is running, create an A2AServer resource:

```yaml
apiVersion: ark.mckinsey.com/v1prealpha1
kind: A2AServer
metadata:
  name: my-a2a-server
spec:
  address:
    value: "http://host.docker.internal:8000"  # For Docker Desktop
    # value: "http://host.minikube.internal:8000"  # For Minikube
  description: "My A2A server"
```

Apply it:
```bash
kubectl apply -f my-a2a-server.yaml
```

ARK will automatically discover your agent and make it available for queries!

## Building Your Own A2A Server

### 1. Start with the Simple Agent Template

```bash
cp -r samples/a2a/simple-agent my-custom-agent
cd my-custom-agent
```

### 2. Modify the Agent Logic

Edit `src/simple_a2a_server/main.py`:

```python
class MyAgentExecutor:
    async def execute(self, context, event_queue):
        # Extract the user's message
        message_text = context.message.parts[0].root.text
        
        # Your custom logic here
        result = await self.process_message(message_text)
        
        # Send response back
        response_message = Message(
            messageId=str(uuid.uuid4()),
            contextId=context.message.context_id,
            taskId=context.task_id,
            role=Role.agent,
            parts=[Part(root=TextPart(kind="text", text=result))],
        )
        await event_queue.enqueue_event(response_message)
```

### 3. Update Agent Card

Modify the skills in `create_agent_card()`:

```python
skills = [
    AgentSkill(
        id="my_skill",
        name="My Skill",
        description="What my agent can do",
        tags=["custom", "example"],
        examples=["Example input 1", "Example input 2"],
        inputModes=["text/plain"],
        outputModes=["text/plain"],
    ),
]
```

### 4. Update Project Configuration

Edit `pyproject.toml`:
```toml
[project]
name = "my-a2a-server"
description = "My custom A2A server"
```

## Deployment Options

### Local Development
```bash
make dev  # Runs on localhost:8000
```

### Kubernetes Deployment
```bash
make install  # Builds Docker image and deploys to K8s
```

## Common Issues

**Connection Refused:**
- Use `http://host.docker.internal:8000` for Docker Desktop
- Use `http://host.minikube.internal:8000` for Minikube

**Agent Not Discovered:**
- Check A2AServer status: `kubectl describe a2aserver my-server`
- Verify agent card: `curl http://your-server/.well-known/agent.json`

## Next Steps

- **[A2A Servers](../../developer-guide/a2a-server)** - ARK A2A server documentation
- **[A2A Gateway](../../developer-guide/a2a-gateway)** - ARK's A2A gateway
- **[A2A Protocol Spec](https://github.com/a2a-integration/a2a-spec)** - Official A2A protocol